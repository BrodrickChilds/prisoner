(function(){var t,e,i,n;$(function(){return $("#game_user_tokens").tokenInput("/users.json",{crossDomain:!1,onAdd:i,hintText:"Type in a friend's name",resultsFormatter:function(t){return"<li><img src='"+t.url+"' title='"+t.name+"' height='25px' width='25px' />"+"<div style='display: inline-block; padding-left: 10px;'><div class='name'>"+t.name+"</div></div></li>"}}),$("a.random-request").click(n)}),n=function(t){return t.preventDefault(),$.ajax({url:$(this).attr("href"),data:null,dataType:"json",type:"GET",complete:function(t){var i;return i=JSON.parse(t.responseText),e(i.user.name,i.user.id,i.url)}}),!1},i=function(){var t,i;return i=$("#game_user_tokens"),t=i.tokenInput("get"),i.tokenInput("clear"),e(t[0].name,t[0].id)},e=function(e,i,n){var s,o,a,r,l;return r=$("<div></div>"),o=$("<div></div>"),a=$("<h4> </h4>"),void 0===n?a.append(e):(a.append("<img src="+n+">"),a.append(e)),s=$("<a href=# class='light-link'>Betray</a>"),l=$("<a href=# class='light-link'>Don't Betray</a>"),o.append(a),o.append(s),o.append("<span> </span>"),o.append(l),r.append(o),s.bind("click",function(){return t(o,"y",i)}),l.bind("click",function(){return t(o,"n",i)}),$(".pending-games").prepend(r)},t=function(t,e,i){var n,s;return n=!1,s=$(".level").attr("id"),"y"===e&&(n=!0),$.ajax({url:"/games",data:{game:{user_id:String(i),opp_strat:n,stage_id:s}},dataType:"script",type:"POST",complete:function(e){var i,n;return t.hide(),n=$("<div> </div>"),n.append(e.responseText),t.parent().append(n),i=function(){return n.fadeOut("slow")},setTimeout(i,5e3)}}),!1}}).call(this);